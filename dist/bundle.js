(()=>{"use strict";const t=document.getElementById("c1"),e=document.getElementById("c2");class a{constructor(t="Title",e="Details of task to be done",a=new Date,n=!1){this.title=t,this.desc=e,this.date=a instanceof Date&&!isNaN(a.getTime())?a:new Date,this.done=n}static formatDate(t){return t instanceof Date&&!isNaN(t.getTime())?new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short",hour12:!1}).format(t):"Invalid Date"}static saveToLocalStorage(){localStorage.setItem("myToDos",JSON.stringify(n.map((t=>({...t,date:t.date.toISOString()}))))),localStorage.setItem("doneToDos",JSON.stringify(s.map((t=>({...t,date:t.date.toISOString()})))))}static loadFromLocalStorage(){const t=localStorage.getItem("myToDos"),e=localStorage.getItem("doneToDos");if(t){const e=JSON.parse(t);n.length=0,e.forEach((t=>n.push(new a(t.title,t.desc,new Date(t.date),t.done))))}if(e){const t=JSON.parse(e);s.length=0,t.forEach((t=>s.push(new a(t.title,t.desc,new Date(t.date),t.done))))}}static printCards(){t.innerHTML="",e.innerHTML="",n.forEach(((e,n)=>{const s=document.createElement("div");s.classList.add("projectBox"),s.innerHTML=`\n                <div class="title" contenteditable="true" data-index="${n}" data-list="active">\n                    ${e.title}\n                </div>\n                <div class="notes">\n                    <div contenteditable="true" data-index="${n}" data-list="active">${e.desc}</div>\n                    <button class="delete" data-index="${n}" data-list="active">\n                        <span class="material-symbols-outlined small">delete</span>\n                    </button>\n                    <button class="tick" data-index="${n}">\n                        <span class="material-symbols-outlined small">check</span>\n                    </button>\n                    <div class = "date">${a.formatDate(e.date)}</div>\n                </div>\n            `,t.appendChild(s)})),s.forEach(((t,n)=>{const s=document.createElement("div");s.classList.add("projectBox","done"),s.innerHTML=`\n                <div class="title" contenteditable="true" data-index="${n}" data-list="done">\n                    ${t.title}\n                </div>\n                <div class="notes">\n                    <div contenteditable="true" data-index="${n}" data-list="done">${t.desc}</div>\n                    <button class="delete" data-index="${n}" data-list="done">\n                        <span class="material-symbols-outlined small">delete</span>\n                    </button>\n                    <button class="tick" data-index="${n}">\n                        <span class="material-symbols-outlined small">check</span>\n                    </button>\n                    <div class = "date">${a.formatDate(t.date)}</div>\n                </div>\n            `,e.appendChild(s)}))}static addCard(){const t=new a;n.push(t),a.saveToLocalStorage(),a.printCards()}static removeCard(t,e){"active"===e?t>=0&&t<n.length&&n.splice(t,1):"done"===e&&t>=0&&t<s.length&&s.splice(t,1),a.saveToLocalStorage(),a.printCards()}static changeDone(t){if(t>=0&&t<n.length){const e=n[t];e.done=!0,s.push(e),n.splice(t,1),a.saveToLocalStorage(),a.printCards()}}static changeDone2(t){if(t>=0&&t<s.length){const e=s[t];e.done=!0,n.push(e),s.splice(t,1),a.saveToLocalStorage(),a.printCards()}}static updateToDoData(t,e,i,o){"active"===e?t>=0&&t<n.length&&(n[t].title=i,n[t].desc=o):"done"===e&&t>=0&&t<s.length&&(s[t].title=i,s[t].desc=o),a.saveToLocalStorage()}}const n=[],s=[];document.addEventListener("DOMContentLoaded",(()=>{a.loadFromLocalStorage(),a.printCards(),t.addEventListener("click",(t=>{const e=t.target.closest("button");if(e){const t=e.getAttribute("data-index"),n=e.getAttribute("data-list");e.classList.contains("delete")?a.removeCard(t,n):e.classList.contains("tick")&&a.changeDone(t)}})),t.addEventListener("blur",(t=>{const n=t.target;if(n.classList.contains("title")||n.classList.contains("notes")){const t=n.getAttribute("data-index"),s=n.getAttribute("data-list"),i=e.querySelector(`.title[data-index="${t}"]`),o=e.querySelector(`.notes > div[data-index="${t}"]`),d=i?i.textContent:"",c=o?o.textContent:"";a.updateToDoData(t,s,d,c)}}),!0),e.addEventListener("click",(t=>{const e=t.target.closest("button");if(e){const t=e.getAttribute("data-index"),n=e.getAttribute("data-list");e.classList.contains("delete")?a.removeCard(t,n):e.classList.contains("tick")&&a.changeDone2(t)}})),e.addEventListener("blur",(t=>{const n=t.target;if(n.classList.contains("title")||n.classList.contains("notes")){const t=n.getAttribute("data-index"),s=n.getAttribute("data-list"),i=e.querySelector(`.title[data-index="${t}"]`),o=e.querySelector(`.notes > div[data-index="${t}"]`),d=i?i.textContent:"",c=o?o.textContent:"";a.updateToDoData(t,s,d,c)}}),!0),document.getElementById("pen").addEventListener("click",a.addCard)}))})();