(()=>{"use strict";const t=document.getElementById("container");class e{constructor(t="Title",e="Details of task to be done",a=new Date,n=!1){this.title=t,this.desc=e,this.date=a instanceof Date&&!isNaN(a.getTime())?a:new Date,this.done=n}static formatDate(t){return t instanceof Date&&!isNaN(t.getTime())?new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short",hour12:!1}).format(t):"Invalid Date"}static saveToLocalStorage(){localStorage.setItem("myToDos",JSON.stringify(a.map((t=>({...t,date:t.date.toISOString()}))))),localStorage.setItem("doneToDos",JSON.stringify(n.map((t=>({...t,date:t.date.toISOString()})))))}static loadFromLocalStorage(){const t=localStorage.getItem("myToDos"),s=localStorage.getItem("doneToDos");if(t){const n=JSON.parse(t);a.length=0,n.forEach((t=>a.push(new e(t.title,t.desc,new Date(t.date),t.done))))}if(s){const t=JSON.parse(s);n.length=0,t.forEach((t=>n.push(new e(t.title,t.desc,new Date(t.date),t.done))))}}static printCards(){t.innerHTML="",a.forEach(((a,n)=>{const s=document.createElement("div");s.classList.add("projectBox"),s.innerHTML=`\n                <div class="title" contenteditable="true" data-index="${n}" data-list="active">\n                    ${a.title}\n                </div>\n                <div class="notes">\n                    <div contenteditable="true" data-index="${n}" data-list="active">${a.desc}</div>\n                    <button class="delete" data-index="${n}" data-list="active">\n                        <span class="material-symbols-outlined small">delete</span>\n                    </button>\n                    <button class="tick" data-index="${n}">\n                        <span class="material-symbols-outlined small">check</span>\n                    </button>\n                    <div class = "date">${e.formatDate(a.date)}</div>\n                </div>\n            `,t.appendChild(s)})),n.forEach(((a,n)=>{const s=document.createElement("div");s.classList.add("projectBox","done"),s.innerHTML=`\n                <div class="title" contenteditable="true" data-index="${n}" data-list="done">\n                    ${a.title}\n                </div>\n                <div class="notes">\n                    <div contenteditable="true" data-index="${n}" data-list="done">${a.desc}</div>\n                    <button class="delete" data-index="${n}" data-list="done">\n                        <span class="material-symbols-outlined small">delete</span>\n                    </button>\n                    <div class = "date">${e.formatDate(a.date)}</div>\n                </div>\n            `,t.appendChild(s)}))}static addCard(){const t=new e;a.push(t),e.saveToLocalStorage(),e.printCards()}static removeCard(t,s){"active"===s?t>=0&&t<a.length&&a.splice(t,1):"done"===s&&t>=0&&t<n.length&&n.splice(t,1),e.saveToLocalStorage(),e.printCards()}static changeDone(t){if(t>=0&&t<a.length){const s=a[t];s.done=!0,n.push(s),a.splice(t,1),e.saveToLocalStorage(),e.printCards()}}static updateToDoData(t,s,i,d){"active"===s?t>=0&&t<a.length&&(a[t].title=i,a[t].desc=d):"done"===s&&t>=0&&t<n.length&&(n[t].title=i,n[t].desc=d),e.saveToLocalStorage()}}const a=[],n=[];document.addEventListener("DOMContentLoaded",(()=>{e.loadFromLocalStorage(),e.printCards(),t.addEventListener("click",(t=>{const a=t.target.closest("button");if(a){const t=a.getAttribute("data-index"),n=a.getAttribute("data-list");a.classList.contains("delete")?e.removeCard(t,n):a.classList.contains("tick")&&e.changeDone(t)}})),t.addEventListener("blur",(a=>{const n=a.target;if(n.classList.contains("title")||n.classList.contains("notes")){const a=n.getAttribute("data-index"),s=n.getAttribute("data-list"),i=t.querySelector(`.title[data-index="${a}"]`),d=t.querySelector(`.notes > div[data-index="${a}"]`),o=i?i.textContent:"",c=d?d.textContent:"";e.updateToDoData(a,s,o,c)}}),!0),document.getElementById("pen").addEventListener("click",e.addCard)}))})();